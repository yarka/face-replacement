<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Replacement - MVP</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-text">
                    <h1>üé¨ Character Replacement</h1>
                    <p class="subtitle">–ó–∞–º–µ–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –≤–∏–¥–µ–æ —Å –ø–æ–º–æ—â—å—é AI</p>
                </div>
                <button id="gallery-btn" class="gallery-btn">
                    üì∏ Gallery <span id="gallery-count" class="gallery-count">(0)</span>
                </button>
            </div>
        </header>

        <!-- Upload Section -->
        <section id="upload-section" class="section">
            <h2>1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –∏–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫–∏</h2>

            <!-- Mode Toggle (hidden, only URL mode enabled) -->
            <div class="mode-toggle hidden" style="display:none">
                <button id="mode-file" class="mode-btn">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª—ã</button>
                <button id="mode-url" class="mode-btn active">üîó –í—Å—Ç–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏</button>
            </div>

            <!-- File Upload Mode -->
            <div id="file-mode" class="upload-mode hidden">
                <div class="upload-grid">
                <!-- Character Image Upload -->
                <div class="upload-box">
                    <label for="character-input" class="upload-label">
                        <div class="upload-content">
                            <span class="icon">üñºÔ∏è</span>
                            <h3>Character Image</h3>
                            <p>–ö–∞—Ä—Ç–∏–Ω–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</p>
                            <p class="hint">JPG, PNG, WebP</p>
                        </div>
                        <input type="file" id="character-input" accept="image/jpeg,image/png,image/webp" hidden>
                    </label>
                    <div id="character-preview" class="preview hidden"></div>
                </div>

                <!-- Reference Video Upload -->
                <div class="upload-box">
                    <label for="reference-input" class="upload-label">
                        <div class="upload-content">
                            <span class="icon">üé•</span>
                            <h3>Reference Video</h3>
                            <p>–†–µ—Ñ–µ—Ä–µ–Ω—Å —Å –¥–≤–∏–∂–µ–Ω–∏—è–º–∏</p>
                            <p class="hint">MP4, MOV</p>
                        </div>
                        <input type="file" id="reference-input" accept="video/mp4,video/quicktime" hidden>
                    </label>
                    <div id="reference-preview" class="preview hidden"></div>
                </div>
                </div>

                <div class="tips">
                    <h4>üí° –°–æ–≤–µ—Ç—ã –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:</h4>
                    <ul>
                        <li>–õ–∏—Ü–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á—ë—Ç–∫–æ –≤–∏–¥–Ω–æ</li>
                        <li>–•–æ—Ä–æ—à–∏–π —Å–≤–µ—Ç, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ –ª–∏—Ü–æ —Ä—É–∫–∞–º–∏</li>
                        <li>–ù–∞—á–Ω–∏—Ç–µ —Å 6-10 —Å–µ–∫—É–Ω–¥ –≤–∏–¥–µ–æ</li>
                    </ul>
                </div>
            </div>

            <!-- URL Mode -->
            <div id="url-mode" class="upload-mode">
                <div class="url-inputs">
                    <div class="url-input-box">
                        <label for="character-url-input">üñºÔ∏è Character Image URL:</label>
                        <input
                            type="url"
                            id="character-url-input"
                            placeholder="https://example.com/character.jpg"
                            class="url-input"
                        >
                        <p class="hint">–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</p>
                    </div>

                    <div class="url-input-box">
                        <label for="reference-url-input">üé• Reference Video URL:</label>
                        <input
                            type="url"
                            id="reference-url-input"
                            placeholder="https://example.com/video.mp4"
                            class="url-input"
                        >
                        <p class="hint">–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å –≤–∏–¥–µ–æ</p>
                    </div>
                </div>

                <div class="tips">
                    <h4>üí° –ü—Ä–∏–º–µ—Ä—ã –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å—Å—ã–ª–æ–∫:</h4>
                    <ul>
                        <li>Cloudinary: https://res.cloudinary.com/...</li>
                        <li>Imgur: https://i.imgur.com/...</li>
                        <li>S3: https://bucket.s3.amazonaws.com/...</li>
                        <li>–õ—é–±–æ–π –ø—Ä—è–º–æ–π URL –∫ —Ñ–∞–π–ª—É</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Model Selection -->
        <section id="model-section" class="section">
            <h2>2. –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å</h2>
            <div class="model-selection">
                <label class="model-option">
                    <input type="radio" name="model" value="runway_act_two" checked>
                    <div class="model-label">
                        <div>
                            <div class="model-title">RunWay Act Two</div>
                            <div class="model-desc">–û–¥–Ω–æ—à–∞–≥–æ–≤–∞—è –∑–∞–º–µ–Ω–∞ –ª–∏—Ü–∞. –ë—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ—Å—Ç–æ.</div>
                        </div>
                        <span class="model-badge">Single-step</span>
                    </div>
                </label>
                <label class="model-option">
                    <input type="radio" name="model" value="seedream_kling">
                    <div class="model-label">
                        <div>
                            <div class="model-title">Seedream 4 Edit + Kling 2.5 Pro</div>
                            <div class="model-desc">3-—ç—Ç–∞–ø–Ω—ã–π pipeline: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–¥—Ä–∞ + –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ.</div>
                        </div>
                        <span class="model-badge pipeline">3-step pipeline</span>
                    </div>
                </label>
            </div>
        </section>

        <!-- Presets Section -->
        <section id="presets-section" class="section">
            <h2>3. Quick Presets</h2>
            <p class="hint">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π –ø—Ä–µ—Å–µ—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</p>

            <div class="presets-grid">
                <button class="preset-btn" data-preset="tiktok">
                    <span class="preset-icon">üéµ</span>
                    <div class="preset-info">
                        <span class="preset-name">TikTok</span>
                        <span class="preset-desc">9:16 –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ</span>
                    </div>
                </button>

                <button class="preset-btn" data-preset="instagram">
                    <span class="preset-icon">üì∏</span>
                    <div class="preset-info">
                        <span class="preset-name">Instagram</span>
                        <span class="preset-desc">1:1 –ö–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ</span>
                    </div>
                </button>

                <button class="preset-btn" data-preset="youtube">
                    <span class="preset-icon">‚ñ∂Ô∏è</span>
                    <div class="preset-info">
                        <span class="preset-name">YouTube</span>
                        <span class="preset-desc">16:9 –®–∏—Ä–æ–∫–æ—Ñ–æ—Ä–º–∞—Ç–Ω–æ–µ</span>
                    </div>
                </button>

                <button class="preset-btn" data-preset="professional">
                    <span class="preset-icon">üíº</span>
                    <div class="preset-info">
                        <span class="preset-name">Professional</span>
                        <span class="preset-desc">–î–µ–ª–æ–≤–æ–π —Å—Ç–∏–ª—å</span>
                    </div>
                </button>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="section">
            <h2>4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</h2>

            <div class="settings-grid">
                <!-- Aspect Ratio -->
                <div class="setting">
                    <label for="ratio-select">–§–æ—Ä–º–∞—Ç –≤–∏–¥–µ–æ:</label>
                    <select id="ratio-select">
                        <option value="1280:720">16:9 (Widescreen)</option>
                        <option value="720:1280">9:16 (Portrait)</option>
                        <option value="960:960">1:1 (Square)</option>
                        <option value="1104:832">4:3 (Landscape)</option>
                        <option value="832:1104">3:4 (Portrait)</option>
                        <option value="1584:672">21:9 (Ultrawide)</option>
                    </select>
                </div>

                <!-- Expression Intensity -->
                <div class="setting">
                    <label for="intensity-slider">
                        –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏–π: <span id="intensity-value">3</span>
                    </label>
                    <input type="range" id="intensity-slider" min="1" max="5" value="3" step="1">
                    <p class="hint">1 = —Å–ª–∞–±–∞—è, 5 = —Å–∏–ª—å–Ω–∞—è</p>
                </div>

                <!-- Body Control -->
                <div class="setting">
                    <label class="checkbox-label">
                        <input type="checkbox" id="body-control" checked>
                        <span>–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–≤–∏–∂–µ–Ω–∏–π —Ç–µ–ª–∞</span>
                    </label>
                    <p class="hint">–í–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–Ω–æ—Å –¥–≤–∏–∂–µ–Ω–∏–π —Ç–µ–ª–∞ –∏–∑ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–∞</p>
                </div>
            </div>

            <button id="generate-btn" class="btn btn-primary">
                üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ
            </button>
        </section>

        <!-- Status Section -->
        <section id="status-section" class="section hidden">
            <h2>‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è...</h2>

            <div class="status-card">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <p id="status-text" class="status-text">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                <p class="hint">–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç</p>
            </div>

            <div id="pipeline-progress" class="pipeline-progress hidden">
                <div class="pipeline-step" id="step-frame">
                    <div class="pipeline-icon" id="step-frame-indicator">‚è≥</div>
                    <div>
                        <div class="pipeline-title">–®–∞–≥ 1: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞–¥—Ä–∞</div>
                        <div class="pipeline-status" id="step-frame-status">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
                    </div>
                </div>
                <div class="pipeline-connector"></div>
                <div class="pipeline-step" id="step-nano-banana">
                    <div class="pipeline-icon" id="step-nano-indicator">‚è∏Ô∏è</div>
                    <div>
                        <div class="pipeline-title">–®–∞–≥ 2: Seedream 4 Edit (–∑–∞–º–µ–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞)</div>
                        <div class="pipeline-status" id="step-nano-status">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
                    </div>
                </div>
                <div class="pipeline-connector"></div>
                <div class="pipeline-step" id="step-veo3">
                    <div class="pipeline-icon" id="step-veo-indicator">‚è∏Ô∏è</div>
                    <div>
                        <div class="pipeline-title">–®–∞–≥ 3: Kling 2.5 Pro (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ)</div>
                        <div class="pipeline-status" id="step-veo-status">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
                    </div>
                </div>
            </div>

            <div id="intermediate-preview" class="intermediate-preview hidden">
                <div class="pipeline-title">–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–ø–æ—Å–ª–µ Seedream Edit)</div>
                <img id="intermediate-image" class="preview-image" alt="Intermediate result">
            </div>
        </section>

        <!-- Result Section -->
        <section id="result-section" class="section hidden">
            <h2>‚úÖ –ì–æ—Ç–æ–≤–æ!</h2>

            <div class="result-card">
                <!-- Comparison View -->
                <div id="comparison-container" class="comparison-container">
                    <div class="comparison-wrapper">
                        <div class="video-side video-side-left">
                            <div class="video-label">Reference</div>
                            <video id="reference-comparison-video" loop muted class="comparison-video"></video>
                        </div>
                        <div class="video-side video-side-right">
                            <div class="video-label">Generated</div>
                            <video id="result-comparison-video" loop muted class="comparison-video"></video>
                        </div>
                        <div id="comparison-slider" class="comparison-slider">
                            <div class="slider-handle"></div>
                        </div>
                    </div>
                    <div class="comparison-controls">
                        <button id="play-comparison" class="btn-icon" title="Play/Pause">
                            ‚ñ∂Ô∏è
                        </button>
                        <button id="toggle-view" class="btn btn-secondary">
                            üîÑ Switch to Single View
                        </button>
                    </div>
                </div>

                <!-- Single Video View -->
                <div id="single-view-container" class="single-view-container hidden">
                    <video id="result-video" controls class="result-video"></video>
                    <button id="toggle-comparison" class="btn btn-secondary" style="margin-top: 16px;">
                        üîÄ Switch to Comparison View
                    </button>
                </div>

                <div class="result-actions">
                    <a id="download-btn" class="btn btn-primary" download>
                        ‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ
                    </a>
                    <button id="again-btn" class="btn btn-secondary">
                        üîÑ –°–æ–∑–¥–∞—Ç—å –µ—â—ë
                    </button>
                </div>
            </div>
        </section>

        <!-- Error Section -->
        <section id="error-section" class="section hidden">
            <h2>‚ùå –û—à–∏–±–∫–∞</h2>

            <div class="error-card">
                <p id="error-text"></p>
                <button id="retry-btn" class="btn btn-primary">
                    üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
                </button>
            </div>
        </section>
    </div>

    <!-- Gallery Modal -->
    <div id="gallery-modal" class="modal hidden">
        <div class="modal-overlay" id="gallery-overlay" onclick="closeGallery()"></div>
        <div class="modal-content gallery-modal-content">
            <div class="modal-header">
                <h2>üì∏ Generation History</h2>
                <button class="modal-close" id="gallery-close">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="gallery-grid" class="gallery-grid">
                    <!-- Gallery items will be inserted here -->
                </div>
                <div id="gallery-empty" class="gallery-empty hidden">
                    <p>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</p>
                    <p class="hint">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ –∏ –æ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Gallery Item Detail Modal -->
    <div id="gallery-detail-modal" class="modal hidden">
        <div class="modal-overlay" id="detail-overlay" onclick="closeDetailModal()"></div>
        <div class="modal-content detail-modal-content">
            <div class="modal-header">
                <h2>Video Details</h2>
                <button class="modal-close" id="detail-close" onclick="closeDetailModal()">‚úï</button>
            </div>
            <div class="modal-body" id="detail-body">
                <!-- Detail content will be inserted here -->
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
